<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>






<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Model</h1>


<div id="TOC">
<ul>
<li><a href="#model" id="toc-model"><span class="toc-section-number">1</span> Model</a></li>
<li><a href="#priors" id="toc-priors"><span class="toc-section-number">2</span> Priors</a></li>
<li><a href="#sampling" id="toc-sampling"><span class="toc-section-number">3</span> Sampling</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>The <code>brms.mmrm</code> R package implements a mixed model of
repeated measures (MMRM), a popular and flexible model to analyze
continuous longitudinal outcomes (<span class="citation">Mallinckrodt et
al. (2008)</span>, <span class="citation">Mallinckrodt and Lipkovich
(2017)</span>, <span class="citation">Holzhauer and Weber
(2024)</span>). <code>brms.mmrm</code> focuses on marginal MMRMs for
randomized controlled parallel studies with discrete time points, where
each patient shares the same set of time points. Whereas the <a href="https://openpharma.github.io/mmrm/"><code>mmrm</code></a> package
is frequentist, <code>brms.mmrm</code> fits models in Bayesian fashion
using <a href="https://paul-buerkner.github.io/brms/"><code>brms</code></a> <span class="citation">(Bürkner 2017)</span>.</p>
<div id="model" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Model</h1>
<p>Let <span class="math inline">\(y_1, \ldots, y_N\)</span> be
independent data points observed for individual patients in a clinical
trial. Each <span class="math inline">\(y_n\)</span> is a numeric vector
of length <span class="math inline">\(T\)</span>, where <span class="math inline">\(T\)</span> is the number of discrete time points
in the dataset (e.g. patient visits in the study protocol). We model
<span class="math inline">\(y_n\)</span> as follows:</p>
<p><span class="math display">\[
\begin{aligned}
y_n \sim \text{Multivariate-Normal}\left ( \text{mean} = X_n b, \
\text{variance} = \Sigma_n \right )
\end{aligned}
\]</span> Above, <span class="math inline">\(X_n\)</span> is the fixed
effect model matrix of patient <span class="math inline">\(n\)</span>,
and its specific makeup is determined by arguments such as
<code>intercept</code> and <code>group</code> in
<code>brm_formula()</code>. <span class="math inline">\(b\)</span> is a
constant-length vector of fixed effect parameters.</p>
<p>The MMRM in <code>brms.mmrm</code> is a <a href="https://paul-buerkner.github.io/brms/articles/brms_distreg.html">distributional
model</a>, which means it uses a linear regression structure for both
the mean and the variance of the multivariate normal likelihood. In
particular, the <span class="math inline">\(T \times T\)</span>
symmetric positive-definite residual covariance matrix <span class="math inline">\(\Sigma_n\)</span> of patient <span class="math inline">\(n\)</span> decomposes as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\Sigma_n &amp;= \text{diag}(\sigma_n) \cdot \Lambda \cdot
\text{diag}(\sigma_n) \\
\sigma_n &amp;= \text{exp} \left ( Z_n b_\sigma \right)
\end{aligned}
\]</span></p>
<p>Above, <span class="math inline">\(\sigma_n\)</span> is a vector of
<span class="math inline">\(T\)</span> time-specific scalar standard
deviations, and <span class="math inline">\(\text{diag}(\sigma_n)\)</span> is a diagonal <span class="math inline">\(T \times T\)</span> matrix. <span class="math inline">\(Z_n\)</span> is a patient-specific matrix which
controls how the <a href="https://paul-buerkner.github.io/brms/articles/brms_distreg.html">distributional
parameters</a> <span class="math inline">\(b_\sigma\)</span> map to the
more intuitive standard deviation vector <span class="math inline">\(\sigma_n\)</span>. The specific makeup of <span class="math inline">\(Z_n\)</span> is determined by the
<code>sigma</code> argument of <code>brm_formula()</code>, which in turn
is produced by <code>brm_formula_sigma()</code>.</p>
<p><span class="math inline">\(\Lambda\)</span> is a symmetric
positive-definite correlation matrix with diagonal elements equal to 1
and off-diagonal elements between -1 and 1. The structure of <span class="math inline">\(\Lambda\)</span> depends on the
<code>correlation</code> argument of <code>brm_formula()</code>, which
could describe an unstructured parameterization, ARMA, compound
symmetry, etc. These alternative structures and priors are available
directly through <code>brms</code>. For specific details, please consult
<a href="https://paul-buerkner.github.io/brms/reference/autocor-terms.html" class="uri">https://paul-buerkner.github.io/brms/reference/autocor-terms.html</a>
and <code>?brms.mmrm::brm_formula</code>.</p>
</div>
<div id="priors" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Priors</h1>
<p>The scalar components of <span class="math inline">\(b\)</span> are
modeled as independent with user-defined priors specified through the
<code>prior</code> argument of <code>brm_model()</code>. The
hyperparameters of these priors are constant. The default priors are
improper uniform for non-intercept terms and a data-dependent Student-t
distribution for the intercept. The variance-related distributional
parameters <span class="math inline">\(b_\sigma\)</span> are given
similar priors</p>
<p>For the correlation matrix <span class="math inline">\(\Lambda\)</span>, the default prior in
<code>brms.mmrm</code> is the <a href="https://mc-stan.org/docs/functions-reference/correlation_matrix_distributions.html#lkj-correlation">LKJ
correlation distribution</a> with shape parameter equal to 1. This
choice of prior is only valid for unstructured correlation matrices.
Other correlation structures, such ARMA, will parameterize <span class="math inline">\(\Lambda\)</span> and allow users to set priors on
those new specialized parameters.</p>
</div>
<div id="sampling" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Sampling</h1>
<p><code>brms.mmrm</code>, through <a href="https://paul-buerkner.github.io/brms/"><code>brms</code></a>, fits
the model to the data using the Markov chain Monte Carlo (MCMC)
capabilities of <a href="https://mc-stan.org/">Stan</a> <span class="citation">(Stan Development Team 2023)</span>. Please read <a href="https://mc-stan.org/users/documentation/" class="uri">https://mc-stan.org/users/documentation/</a> for more
details on the methodology of <a href="https://mc-stan.org/">Stan</a>.
The result of MCMC is a collection of draws from the full joint
posterior distribution of the parameters given the data. Individual
draws of scalar parameters such as <span class="math inline">\(\beta_3\)</span> are considered draws from the
marginal posterior distribution of e.g. <span class="math inline">\(\beta_3\)</span> given the data.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-burkner2017" class="csl-entry">
Bürkner, P.-C. (2017), <span>“<span class="nocase">brms</span>: An
<span>R</span> package for <span>Bayesian</span> multilevel models using
<span>Stan</span>,”</span> <em>Journal of Statistical Software</em>, 80,
1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>.
</div>
<div id="ref-bamdd" class="csl-entry">
Holzhauer, B., and Weber, S. (2024), <span>“<a href="https://opensource.nibr.com/bamdd/src/02h_mmrm.html"><span class="nocase">Bayesian Mixed effects Model for Repeated
Measures</span></a>,”</span> in <em><span class="nocase">Applied
Modeling in Drug Development</span></em>, <span>Novartis AG</span>.
</div>
<div id="ref-mallinckrodt2008" class="csl-entry">
Mallinckrodt, C. H., Lane, P. W., Schnell, D., and others (2008),
<span>“Recommendations for the primary analysis of continuous endpoints
in longitudinal clinical trials,”</span> <em>Therapeutic Innovation and
Regulatory Science</em>, 42, 303–319. <a href="https://doi.org/10.1177/009286150804200402">https://doi.org/10.1177/009286150804200402</a>.
</div>
<div id="ref-mallinckrodt2017" class="csl-entry">
Mallinckrodt, C. H., and Lipkovich, I. (2017), <em>Analyzing
longitudinal clinical trial data: A practical guide</em>, CRC Press,
Taylor; Francis Group.
</div>
<div id="ref-stan2023" class="csl-entry">
Stan Development Team (2023), <em><a href="https://mc-stan.org">Stan
modeling language users guide and reference manual</a></em>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
